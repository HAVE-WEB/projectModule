<!doctype html>
<html class="no-js">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="">
    <meta name="keywords" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>商品列表</title>

    <!-- Set render engine for 360 browser -->
    <meta name="renderer" content="webkit">

    <!-- No Baidu Siteapp-->
    <meta http-equiv="Cache-Control" content="no-siteapp"/>

    <link rel="icon" type="image/png" href="i/favicon.png">

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">
    <link rel="icon" sizes="192x192" href="i/app-icon72x72@2x.png">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Amaze UI"/>
    <link rel="apple-touch-icon-precomposed" href="i/app-icon72x72@2x.png">

    <!-- Tile icon for Win8 (144x144 + tile color) -->
    <meta name="msapplication-TileImage" content="i/app-icon72x72@2x.png">
    <meta name="msapplication-TileColor" content="#0e90d2">

    <!-- Amaze UI CSS -->
    <link rel="stylesheet" href="../../assets/css/amazeui.css">
    <link rel="stylesheet" href="../../assets/css/sl.css">
    <script src="../../assets/js/jquery.min.js"></script>
    <script src="../../assets/js/amazeui.js"></script>
    <script src="../../assets/js/myFirst.js"></script>
    <style>
        div.am-tabs-bd button{
            /*border: 6px solid red;*/
            padding: 0.2rem 0.6rem;
            color: white;
            background-color: red;
            /*-webkit-border-radius: 2px;*/
            /*-moz-border-radius: 2px;*/
            /*border-radius: 0.8rem;*/
        }

        ::-webkit-scrollbar{
            width: 0.1rem;
        }

    </style>

</head>
<body >
<div class="top-div" style="width: 100%;position:fixed;top: 0px;left: 0px;z-index: 10001">
    <div class="sl-flex-row-center-flex-start " style="background-color: red;height: 3rem;padding-left: 0.8rem;">
        <img src="../../assets/images/back.png" alt="" style="width: 1.5rem;height: 1.5rem;" onclick="goBack()">
        <div style="color: white;" class="title">福利清单</div>
    </div>
</div>
<div style="margin-top: 3.2rem;">
    <ul class="am-avg-sm-2" style="background-color: white;" id="list">
        <li data-fruit-type="0">
            <div class="sl-margin-04rem-04rem-04rem-08rem sl-border-1px-solid-D3D3D3">
                <div class="sl-background-color-F6F6F6 sl-flex-row-center-center sl-padding-1rem">
                    <img src="../../assets/images/fruits/pg/slider/pg_2.jpg" alt="" style="width: 100%;height: 100%;">
                </div>
                <div class="sl-border">
                    <div class="am-text-truncate">智利嘎啦果6个115g以上/个</div>
                    <div class="sl-flex-row-center-space-between data-JF-KC">
                        <div class="sl-flex-row-center-flex-start">
                            <img src="../../assets/images/money.png" alt="" style="width: 1rem;height: 1rem;">
                            <span style="color: red;">120</span>
                            <span> &nbsp;积分</span>
                        </div>
                        <div>
                            <span>库存:</span><b style="color: red;">100</b>
                        </div>
                    </div>
                    <div class="sl-flex-row-center-space-between">
                        <div style="font-size: .6rem;">
                            <span>由</span><b style="color: #44b549;">易批购商城</b><span>提供</span>
                        </div>
                        <div>
                            <button class="ls-button">兑换</button>
                        </div>
                    </div>
                </div>
            </div>
        </li>
        <li data-fruit-type="1">
            <div class="sl-margin-04rem-08rem-04rem-04rem sl-border-1px-solid-D3D3D3">
                <div class="sl-background-color-F6F6F6 sl-flex-row-center-center sl-padding-1rem">
                    <img src="../../assets/images/fruits/gng/slider/gng_2.jpg" alt="" style="width: 100%;height: 100%;">
                </div>
                <div class="sl-border">
                    <div class="am-text-truncate">吉林长白山菇娘果500g</div>
                    <div class="sl-flex-row-center-space-between data-JF-KC">
                        <div class="sl-flex-row-center-flex-start">
                            <img src="../../assets/images/money.png" alt="" style="width: 1rem;height: 1rem;">
                            <span style="color: red;">150</span>
                            <span> &nbsp;积分</span>
                        </div>
                        <div>
                            <span>库存:</span><b style="color: red;">60</b>
                        </div>
                    </div>
                    <div class="sl-flex-row-center-space-between">
                        <div style="font-size: .6rem;">
                            <span>由</span><b style="color: #44b549;">易批购商城</b><span>提供</span>
                        </div>
                        <div>
                            <button class="ls-button">兑换</button>
                        </div>
                    </div>
                </div>
            </div>
        </li>
    </ul>
</div>
<div class="am-modal am-modal-prompt" tabindex="-1" id="my-prompt">
    <div class="am-modal-dialog">
        <div class="am-modal-hd" style="border-bottom: 1px solid #CACACA;">兑换信息</div>
        <div class="sl-flex-column-flex-start-center">
            <header class="sl-header">兑换方式：积分兑换</header>
            <div class="am-modal-bd ">
                <table>
                    <tr>
                        <td style="width: 40%;">您的积分</td>
                        <td style="width: 30%;">300</td>
                        <td style="width: 30%;">积分</td>
                    </tr>
                    <tr>
                        <td>兑换价格</td>
                        <td></td>
                        <td>积分</td>
                    </tr>
                    <tr>
                        <td>库存</td>
                        <td style="color: red;"><b></b></td>
                        <td>个</td>
                    </tr>
                    <tr>
                        <td>可兑换数</td>
                        <td style="color: red;"><b></b></td>
                        <td>个</td>
                    </tr>
                    <tr>
                        <td>数量</td>
                        <td colspan="2"><input type="number" oninput="checkVal(this)" class="am-modal-prompt-input"></td>
                    </tr>
                </table>
            </div>
            <header class="sl-header">兑换方式：兑换码兑换</header>
            <div class="am-modal-bd" style="width: 100%;">
                <table style="width: 100%;">
                    <tr>
                        <td style="width: 40%;"></td>
                        <td style="width: 30%;"></td>
                        <td style="width: 30%;"></td>
                    </tr>
                    <tr>
                        <td >兑换码</td>
                        <td colspan="2"><input type="number" class="am-modal-prompt-input" ></td>
                    </tr>
                </table>
            </div>
            <header class="sl-header">兑换方式：二维码兑换</header>
            <div class="am-modal-bd" style="width: 100%;">
                <table style="width: 100%;">
                    <tr>
                        <td style="width: 40%;"></td>
                        <td style="width: 30%;"></td>
                        <td style="width: 30%;"></td>
                    </tr>
                    <tr>
                        <td >兑换码</td>
                        <td colspan="2"><input type="number" class="am-modal-prompt-input" ></td>
                    </tr>
                </table>
            </div>
        </div>
        <div class="am-modal-footer">
            <span class="am-modal-btn" data-am-modal-cancel>取消</span>
            <span class="am-modal-btn" data-am-modal-confirm>提交</span>
        </div>
    </div>
</div>
<div class="sl-flex-column-center-center" style="width: 100%;background-color: white;" id="translate">
    <div style="width: 100%;text-align: center;">商品参数</div>
    <!--overflow: scroll;height: 12rem-->
    <div class="sl-flex-column-flex-start-center">
        <header class="sl-header">兑换方式：积分兑换</header>
        <div class="am-modal-bd ">
            <table>
                <tr>
                    <td style="width: 40%;">您的积分</td>
                    <td style="width: 30%;">300</td>
                    <td style="width: 30%;">积分</td>
                </tr>
                <tr>
                    <td>兑换价格</td>
                    <td></td>
                    <td>积分</td>
                </tr>
                <tr>
                    <td>库存</td>
                    <td style="color: red;"><b></b></td>
                    <td>个</td>
                </tr>
                <tr>
                    <td>可兑换数</td>
                    <td style="color: red;"><b></b></td>
                    <td>个</td>
                </tr>
                <tr>
                    <td>数量</td>
                    <td colspan="2"><input type="number" oninput="checkVal(this)" class="am-modal-prompt-input"></td>
                </tr>
            </table>
        </div>
        <header class="sl-header">兑换方式：兑换码兑换</header>
        <div class="am-modal-bd" style="width: 100%;">
            <table style="width: 100%;">
                <tr>
                    <td style="width: 40%;"></td>
                    <td style="width: 30%;"></td>
                    <td style="width: 30%;"></td>
                </tr>
                <tr>
                    <td >兑换码</td>
                    <td colspan="2"><input type="number" class="am-modal-prompt-input" ></td>
                </tr>
            </table>
        </div>
        <header class="sl-header">兑换方式：二维码兑换</header>
        <div class="am-modal-bd" style="width: 100%;">
            <table style="width: 100%;">
                <tr>
                    <td style="width: 40%;"></td>
                    <td style="width: 30%;"></td>
                    <td style="width: 30%;"></td>
                </tr>
                <tr>
                    <td >兑换码</td>
                    <td colspan="2"><input type="number" class="am-modal-prompt-input" ></td>
                </tr>
            </table>
        </div>
    </div>
    <div style="background-color: red;color: white;width: 100%;text-align: center;padding: 0.3rem;" onclick="hideTied()">完成</div>
</div>


<div class="sl-flex-row-center-space-around sl-padding-15px-0px-5px-0px"  style="position: fixed;z-index: 1001;top: 80%;left: 80%;display: none" id="up">
   <div class="sl-flex-column-center-center sl-background-color-F1F1F1 "  style="height: 3rem ; width: 3rem;padding: 0.3rem;">
       <img src="../../assets/images/backTop.png" alt="" style="max-height: 100%;max-width: 100%;">
   </div>
</div>

<div data-am-widget="navbar" class="am-navbar am-cf am-navbar-default " style="border-top: 2px solid #E5E5E5;">
    <ul class=" am-navbar-nav am-cf am-avg-sm-4 ">
        <li >
            <a href="#" class="">
                <img src="../../assets/images/bottomNavClick/首页.png" alt="">
                <span class="am-navbar-label  sl-font-color-red">首页</span>
            </a>
        </li>
        <!--<li >-->
            <!--<a href="" class="">-->
                <!--<img src="../assets/images/bottomNav/搜索.png" alt="">-->
                <!--<span class="am-navbar-label sl-icon-color-6D6D6D">搜索</span>-->
            <!--</a>-->
        <!--</li>-->
        <!--<li data-am-navbar-share>-->
            <!--<a href="" class="">-->
                <!--<img src="../assets/images/bottomNav/购物车.png" alt="">-->
                <!--<span class="am-navbar-label sl-icon-color-6D6D6D">购物车</span>-->
            <!--</a>-->
        <!--</li>-->
        <li >
            <a href="my.html" class="">
                <!--<i class="fa fa-user-o sl-icon-color-6D6D6D"></i>-->
                <img src="../../assets/images/bottomNav/我的.png" alt="">
                <span class="am-navbar-label sl-icon-color-6D6D6D">我的</span>
            </a>
        </li>
    </ul>
</div>
<!--灰色层-->
<div id="grayTier"></div>
<!--图片层-->
<div style="width: 5rem;height: 5rem;background-color: red;" id="imgTier">
    <img src="" alt="" style="width: 100%;height: 100%;-webkit-border-radius: 50%;-moz-border-radius: 50%;border-radius: 50%;">
</div>





</body>
</html>
<script>
    //全局变量
    var rem = new Rem();
    var num = 0;
    var numKC = 0;
    var wH = screen.height;
    var wW = screen.width;
    //回顶部
    $("#up").click(function () {
        $('html, body').animate({scrollTop: 0}, '500');
    })

    //排序
    $('ul.am-dropdown-content li').click(function () {
        $(this).addClass('am-active').siblings('li').removeClass('am-active');
    })

    //点击兑换按钮
//    $(function () {
//        $('button').on('click', function () {
//            var  price= $(this).parent().parent().prev().find('span:eq(0)').html();
//            numKC =  $(this).parent().parent().prev().find('b').html();
//
////            var price = parseInt($(this).prev().find('span:first').html());//获取商品价格
////            numKC =  parseInt($(this).parent().prev().html());
//           var $tr = $('table:eq(0) tr');
//            $tr.eq(1).children('td').eq(1).html(price);//将商品价格放入到td中
//            var yourJF = parseInt($tr.eq(0).children('td').eq(1).html());//你的所有积分
//            num = parseInt(yourJF / price);
//            $tr.eq(2).children('td').eq(1).find('b').html(numKC);//你的积分可以购买的个数
//            $tr.eq(3).children('td').eq(1).find('b').html(num)//库存
//            if(num > numKC){
//                $tr.eq(4).children('td').eq(1).find('input').attr('max',numKC);
//            } else {
//                $tr.eq(4).children('td').eq(1).find('input').attr('max',num);
//            }
//
//            var dH = $('#translate').outerHeight();
//            $('#grayTier').show();
//            $('#translate').animate({
//                top: wH-dH
//            },300);
//
////            $('#my-prompt').modal({
////                relatedTarget: this,
////                onConfirm: function(e) {
////                    var tempNum =parseInt($.trim(e.data[0])) ;
////                    var tempNum1 =parseInt($.trim(e.data[1])) ;
////                    console.log("f:"+tempNum+'.s:'+tempNum1);
////                    if(isNaN(tempNum)){//先判断是不是数字
////                        rem.alertInfoByState('兑换失败',1)
////                    }else{
////                        rem.alertInfoByState('兑换成功',0)
////                    }
////                },
////                onCancel: function(e) {
//////                    alert('不想说!');
////                }
////            });
//        })
//    });
    //时时刻刻检查输入框中的值
    function checkVal(self) {
        var flag = false;
        var f = $(self).val();
        if(f.indexOf('.') > 0){
            flag = true;
        }
        var n = parseInt($(self).val());
        if(isNaN(n) || n <= 0  ||flag){
            $(self).val('');
            rem.alertInfoByState('请输入正整数',1)
        }
        if(num > numKC){
            if( n > numKC ){
                $(self).val('');
                rem.alertInfoByState('库存不足',1)
            }
        }else{
            if( n > num ){
                $(self).val('');
                rem.alertInfoByState('积分不足',1)
            }
        }

    }

    //点击商品列表
    $("#list li").mousedown(function (e) {
        var cX = e.pageX;//鼠标对象相对于文档对象的左边缘的位置

        var cY = e.pageY;//鼠标对象相对于文档对象的顶部边缘的位置
        var $b = $(this).find('button')
        var bW = $b.outerWidth();
        var bH = $b.outerHeight();
        var bX = $b.offset().left;//元素对象相对于文档对象的左边缘的位置
        var bY = $b.offset().top;//元素对象相对于文档对象的顶部边缘的位置

        if (cX >= bX && cX <= bX + bW && cY >= bY && cY <= bY + bH) {
            var $img = $(this).children('div:eq(0)').children('div:eq(0)').find('img');
            var s = $img.attr('src');
            var $iT = $('#imgTier').find('img');
            $iT.attr('src', s);
            var itH = $iT.outerHeight();
            var itW = $iT.outerWidth();
            $("#imgTier").css({
                position: 'fixed',
                top: wH,
                left: (wW - itW-itW/2),
                zIndex: 10007,
            });

            $("#translate").css({
                position: 'fixed',
                top: wH + itH / 2,
                left: 0,
                zIndex: 10006,
            })


            var dH = $('#translate').outerHeight();
            $('#grayTier').show();
            $('#translate').animate({
                top: wH - dH
            }, 1000);
            $('#imgTier').animate({
                top: wH - (dH + itH / 2)
            }, 1000);
        } else {
            //积分信息
            var price = $(this).find('div.data-JF-KC').find('span:eq(0)').html();
            var KC = $(this).find('div.data-JF-KC').find('b').html();
            var yourJF = 300;
            console.log("P:" + price + "KC:" + KC);
            sessionStorage.setItem('yourJF', yourJF);
            sessionStorage.setItem('price', price);
            sessionStorage.setItem('KC', KC);
            var t = $(this).data('fruitType');
            console.log("t:" + t);
            console.log(typeof t);
//            if(t === 0){
//                location.href = 'apple.html'
//            }else if(t === 1){
//                location.href = 'girlFruit.html'
//            }
            location.href = 'commodityDetail.html'
        }
    })
    //标题文字居中
    $(function () {
        rem.titleCenter();
    });
    //退回
    function goBack() {
        history.back();
    };

    //将商品信息隐藏
    $(function () {
        $("#imgTier").css({
            position: 'fixed',
            top: wH,
            left: 0,
            zIndex: 10007,
        });
        $("#translate").css({
            position: 'fixed',
            top: wH,
            left: 0,
            zIndex: 100005,
        })
    });

    //灰色一层
    $(function () {
        var wW = screen.width;
        $('#grayTier').css({
            position: 'fixed',
            top: 0,
            left: 0,
            width: wW,
            height: wH,
            backgroundColor: '#A5A4A5',
            zIndex: 10002,
            display: 'none',
            opacity: 0.5
        })
    });
    //点击灰色层隐藏
    $('#grayTier').on('click',function () {
        hideTied();
    }) ;
    //点击商品信息
    $('#commodityInfo').click(function () {

        var dH = $('#translate').outerHeight();
        $('#grayTier').show();
        $('#translate').animate({
            top: wH-dH
        },300);
    });
    //隐藏灰色层和商品信息层
    function hideTied() {
        $('#grayTier').hide();
        var $iH = $('#imgTier').outerHeight();
        $('#translate').animate({
            top: wH+$iH/2
        },500);
        $('#imgTier').animate({
            top: wH
        },500);
    }
</script>